setwd("~/Desktop")
library(fishtree)
library(phytools)
setwd("~/Downloads/doi_10")
Data1 <- read.csv("NZ-FISH-TRAITS-Raw-Trait-Data.csv")
setwd("/Users/spencercutlip/Downloads")
untar("actinopt_full.trees.xz")
source("~/Downloads/doi_10/project 1.R")
source("~/Downloads/doi_10/project 1.R", echo=TRUE)
trees <- list()
births <- vector()
Fractions <- vector()
for (i in 1:100) {
births [i]<- runif(1, 0, 1)
Fractions [i]<- runif(1, 0, 1)
trees<- pbtree(n=1, b=births)
}
for (i in 1:100) {
births [i]<- runif(1, 0, 1)
Fractions [i]<- runif(1, 0, 1)
trees<- pbtree(n=1, b=births [i], d=Fractions [i] * births [i])
netdiversification <- (births [i] - Fractions[i] * births[i])
}
netdiversification <- vector()
library(phytools)
trees <- list()
births <- vector()
Fractions <- vector()
netdiversification <- vector()
speciationrate <- vector()
pbtree
totaltreetips <- log(sapply(trees, Ntip))
for (i in 1:100) {
births [i]<- runif(1, 0, 1)
Fractions [i]<- runif(1, 0, 1)
trees[[i]]<- pbtree(n=100, b=births [i], d=Fractions [i] * births [i])
netdiversification <- (births [i] - Fractions[i] * births[i])
}
totaltreetips <- log(sapply(trees, Ntip))
logtreetips <- log(treetips)
plot(netdiversification, totaltreetips)
totaltreetips <- log(sapply(trees, Ntip))
plot(netdiversification, totaltreetips)
plot(netdiversification, totaltreetips, netdr, treetips, log)
for (i in 1:100) {
births [i]<- runif(1, 0, 1)
Fractions [i]<- runif(1, 0, 1)
trees[[i]]<- pbtree(n=100, b=births [i], d=Fractions [i] * births [i])
netdiversification <- (births [i] - Fractions[i] * births[i])
}
pbtree
totaltreetips <- log(sapply(trees, Ntip))
plot(netdiversification, totaltreetips)
library(phytools)
trees <- list()
births <- vector()
Fractions <- vector()
netdiversification <- vector()
speciationrate <- vector()
for (i in 1:100) {
births [i]<- runif(1, 0, 1)
Fractions [i]<- runif(1, 0, 1)
trees[[i]]<- pbtree(n=100, b=births [i], d=Fractions [i] * births [i])
netdiversification <- (births [i] - Fractions[i] * births[i])
}
totaltreetips <- log(sapply(trees, Ntip))
plot(netdiversification, totaltreetips)
library(phytools)
trees <- list()
births <- vector()
Fractions <- vector()
netdiversification <- vector()
for (i in 1:100) {
births [i]<- runif(1, 0, 1)
Fractions [i]<- runif(1, 0, 1)
trees[[i]]<- pbtree(n=100, b=births [i], d=Fractions [i] * births [i])
netdiversification <- (births [i] - Fractions[i] * births[i])
}
totaltreetips <- log(sapply(trees, Ntip))
plot(netdiversification, totaltreetips)
for (i in 1:100) {
births [i]<- runif(1, 0, 1)
Fractions [i]<- runif(1, 0, 1)
trees[[i]]<- pbtree(n=100, b=births [i], d=Fractions [i] * births [i])
netdiversification[i] <- (births [i] - Fractions[i] * births[i])
}
totaltreetips <- log(sapply(trees, Ntip))
plot(netdiversification, totaltreetips)
library(phytools)
trees <- list()
births <- vector()
Fractions <- vector()
netdiversification <- vector()
speciationrate <- vector()
avgbranch <- vector()
for (i in 1:100) {
births [i]<- runif(1, 0, 1)
Fractions [i]<- runif(1, 0, 1)
trees[[i]]<- pbtree(n=100, b=births [i], d=Fractions [i] * births [i])
netdiversification[i] <- (births [i] - Fractions[i] * births[i])
speciationrate[i] <- births[i]
avgbranch[[i]] <- mean(trees[[i]] $edge.length)
}
totaltreetips <- log(sapply(trees, Ntip))
#Q4
plot(netdiversification, totaltreetips)
line <- lm(totaltreetips ~ netdiversification)
abline(line)
#As net diversification increases log of total tips increases
#Q5
plot(speciationrate, avgbranch)
#speciation rate increases and avg branch length decreases
#Q6
cor(speciationrate, avgbranch)
#-0.4500243
#Q7
trees
#-0.4500243
#Q7
trees
tree[2]
trees[2]
Tree <- trees[2]
plot(Tree)
plot.phylo(Tree)
Tree
phylo.to.map()
plot(Tree)
phylo.to.map(tree, coords, roatate=TRUE)
phylo.to.map(Tree, coords, roatate=TRUE)
Tree <- trees[[2]]
plot(Tree)
rates <- vector()
source("~/Desktop/Evolution/Tasks/Task_10/task10.r", echo=TRUE)
traits <- vector()
traits <- list()
for (i in 1:100) {
rates[i] <- runif(1)
traits[[i]] <- fastBM(Tree, sig2=rates[i])
}
#Q8
cor(mean(traits), rates)
#Q8
cor(mean(traits[[i]]), rates[i])
#Q8
cor(mean(traits[[i]]), rates)
mean(traits)
mean(rates[i])
#Q8
cor(mean(traits[[i]]), mean(rates[i]))
mean(rates)
mean(rates[i])
#Q8
cor(mean(traits[[i]]), mean(rates))
#Q8
cor(mean(traits[[i]]), rates)
#Q8
cor(mean(traits), rates)
#Q8
cor(mean(traits[[i]]), rates[i], use = "complete.obs")
#Q8
cor(mean(traits[[i]]), rates[i], use = "complete")
#Q8
cor(mean(traits[[i]]), rates, use = "complete")
#Q8
cor(mean(traits[[i]]), rates)
head(rates)
head(mean(traits))
head(traits)
mean(traits)
mean(traits, trim = 0.25)
mean(traits, trim = 0.5)
mean(trait[[i]])
mean(traits[[i]])
mean(traits)
$traits
length(traits)
length(traits[[i]])
length(traits)
head(traits)
head(traits[[i]])
sappply(traits, mean)
library(phytools)
sappply(traits, mean)
sapply(traits, mean)
mtraits <- sapply(traits, mean)
cor(mtriats, rates)
cor(mtraits, rates)
plot(mtraits, rates)
#there is a positive correlation between mean of traits and rates 0.008
#Q9
sapply(traits, var)
#there is a positive correlation between mean of traits and rates 0.008
#Q9
vartraits <- sapply(traits, var)
cor(vartraits, rates)
plot(vartraits, rates)
#positive variation between the correlation between the variation of traits and rates 0.78
#Q10
sapply(traits, "[[",1)
sapply(traits, "[[",2)
#positive variation between the correlation between the variation of traits and rates 0.78
#Q10
element1 <- sapply(traits, "[[",1)
element2 <- sapply(traits, "[[",2)
cbind(element1, element2)
plot(element1, element2)
traitMat <- cbind(element1, element2)
cor(element1, element2)
Q8c <- cor(mtraits, rates)
Q9c <- cor(vartraits, rates)
Q10c <- cor(element1, element2)
Q10c
Q8pt <- plot(mtraits, rates)
Q9pt <- plot(vartraits, rates)
pdf("Q10 cor element1 vs element2")
plot(Q10pt)
Q10pt <- plot(element1, element2)
plot(Q10pt)
dev.off()
plot(Q10pt)
plot(element1, element2)
Q10pt
plot(Q10pt)
pdf("Q10 element vs element")
plot(element1, element2)
dev.off()
setwd('~/Desktop/Evolution/Tasks/Task_10')
pdf("Q8 cor mtraits vs rates.pdf")
plot(mtraits, rates)
dev.off()
pdf("Q9 cor vartraits, rates.pdf")
plot(vartraits, rates)
dev.off()
pdf("Q10 element1 vs element2.pdf")
plot(element1, element2)
dev.off()
phylomorphospace(Tree, traitMat)
#there is a positive correlation between element 1 and element 2 of the traits 0.375
#
#Bonus
phylomorphospace(Tree, traits(element1,element2))
#there is a positive correlation between element 1 and element 2 of the traits 0.375
#
#Bonus
phylomorphospace(Tree, traits[element1,element2])
#there is a positive correlation between element 1 and element 2 of the traits 0.375
#
#Bonus
phylomorphospace(Tree, traits[,1:,2])
#there is a positive correlation between element 1 and element 2 of the traits 0.375
#
#Bonus
phylomorphospace(Tree, traits[,1:2])
#there is a positive correlation between element 1 and element 2 of the traits 0.375
#
#Bonus
phylomorphospace(Tree, traits[1:2])
#there is a positive correlation between element 1 and element 2 of the traits 0.375
#No it is not significant as it randomly simulates the elements and it is positively correlated each time
#meaning overall there is no significance in a positive correlation value
#Bonus
TreeB <- pbtree(n=100)
X <- fastBM(TreeE, nsim=2)
X <- fastBM(TreeB, nsim=2)
phylomorphospace(TreeB, X, xlab="element1", ylab="element2")
